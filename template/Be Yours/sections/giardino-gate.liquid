{% schema %}
{
  "name": "Giardino Gate",
  "settings": [
    {
      "type": "text",
      "id": "password",
      "label": "Access password",
      "default": "giardino"
    },
    {
      "type": "image_picker",
      "id": "background",
      "label": "Background image"
    }
  ],
  "presets": [
    {
      "name": "Giardino Gate"
    }
  ]
}
{% endschema %}

<div class="giardino-wrapper">

  <!-- Gate -->
  <div class="giardino-gate" id="giardinoGate">
    <div class="giardino-bg"
      style="background-image: url({{ section.settings.background | image_url: width: 2000 }});">
    </div>

    <div class="giardino-overlay"></div>

    <div class="giardino-content">
      <h1>Il Giardino Segreto</h1>

      <input type="password" id="giardinoInput" placeholder="Inserisci la chiave">
      <button id="giardinoButton">Continua</button>

      <p class="giardino-subtext">
        Con l’acquisto di tre prodotti riceverai la chiave per accedere al Giardino Segreto.
        Con una Lotion, l’accesso è immediato.
        Vai allo <a href="/collections/all">SHOP</a>
      </p>
    </div>
  </div>

  <!-- Actual Page Content -->
  <div class="giardino-page-content" id="giardinoContent">
    {{ page.content }}
  </div>

</div>

<style>
.giardino-wrapper {
  position: relative;
}

.giardino-gate {
  position: relative;
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  color: white;
  overflow: hidden;
}

.giardino-bg {
  position: absolute;
  inset: 0;
  background-size: cover;
  background-position: center;
  z-index: 1;
}

.giardino-overlay {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.25);
  z-index: 2;
}

.giardino-content {
  position: relative;
  z-index: 3;
  max-width: 500px;
  padding: 60px 20px;
}

.giardino-content input {
  width: 100%;
  padding: 14px;
  margin-top: 20px;
  border: none;
}

.giardino-content button {
  margin-top: 15px;
  padding: 14px 30px;
  border: none;
  cursor: pointer;
}

.giardino-subtext {
  margin-top: 25px;
  font-size: 0.9rem;
  opacity: 0.85;
}

.giardino-page-content {
  display: none;
  animation: fadeIn 0.6s ease forwards;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
</style>

<script>
document.addEventListener("DOMContentLoaded", function() {
  const correctPassword = "{{ section.settings.password }}";
  const gate = document.getElementById("giardinoGate");
  const content = document.getElementById("giardinoContent");

  if (sessionStorage.getItem("giardinoUnlocked") === "true") {
    gate.style.display = "none";
    content.style.display = "block";
  }

  document.getElementById("giardinoButton").addEventListener("click", function() {
    const input = document.getElementById("giardinoInput").value;

    if (input === correctPassword) {
      sessionStorage.setItem("giardinoUnlocked", "true");
      gate.style.display = "none";
      content.style.display = "block";
    } else {
      alert("La chiave non è corretta.");
    }
  });
});
</script>
